# TravelPMS 수동 E2E 테스트 가이드

## 테스트 준비
1. 서버 실행: `./start.sh` 또는 `cd backend && npm start`
2. 브라우저에서 http://localhost:3000 접속
3. 아래 테스트 시나리오를 순서대로 진행

---

## 📝 테스트 시나리오

### 1단계: 프로젝트 생성 ✅
**목표**: 새 여행 프로젝트 생성하기

1. 홈 화면에서 "새 프로젝트" 또는 "여행 시작" 버튼 클릭
2. 목적지 선택: 예) 도쿄, 오사카, 파리 등
3. 여행 정보 입력:
   - 여행 기간: 2026-03-01 ~ 2026-03-05 (5일)
   - 인원: 2명
   - 총 예산: 2,000,000원
4. "프로젝트 생성" 클릭

**예상 결과**:
- 프로젝트가 생성되고 상세 페이지로 이동
- 예산이 자동으로 카테고리별로 배분됨
- 상단에 프로젝트 제목과 목적지가 표시됨

---

### 2단계: 예산 현황 확인 ✅
**목표**: 자동 배분된 예산 카테고리 확인

**"예산" 탭에서 확인할 사항**:
1. 총 예산: 2,000,000원 표시
2. 카테고리별 예산:
   - 숙소 (Accommodation)
   - 식비 (Food)
   - 활동 (Activities)
   - 교통 (Transportation)
   - 쇼핑 (Shopping)
   - 기타 (Other)
3. 각 카테고리마다:
   - 배정된 금액 (allocated)
   - 사용 금액 (spent = 0)
   - 사용률 (0%)
   - 프로그레스 바

**예상 결과**:
- 모든 카테고리의 사용 금액이 0원
- 총 사용률 0%
- 알림 배너 없음 (예산 초과 없음)

---

### 3단계: 트랜잭션 추가 (지출 입력) ✅
**목표**: 숙소 예약 지출 추가하기

1. "숙소" 카테고리 카드 클릭
2. 우측에서 트랜잭션 패널 열림
3. "+ 지출 추가" 버튼 클릭
4. 지출 정보 입력:
   - 카테고리: accommodation (숙소)
   - 금액: 250,000원
   - 설명: "도쿄 호텔 예약"
   - 날짜: 2026-03-01
   - 통화: KRW
5. "추가" 버튼 클릭

**예상 결과**:
- 트랜잭션 목록에 "도쿄 호텔 예약 250,000원" 표시
- 숙소 카테고리:
  - 사용 금액: 250,000원
  - 사용률: 약 40% (숙소 예산이 600,000원인 경우)
  - 프로그레스 바 업데이트
- 총 예산 사용률: 12.5% (250,000 / 2,000,000)

---

### 4단계: AI 추천 확인 ✅
**목표**: AI 기반 숙소 추천 받기

1. "숙소" 카테고리 카드에서 "💡 클릭하여 AI 추천 보기" 클릭
2. AI 추천 모달창 열림 (2-3초 로딩)

**예상 결과**:
- 실제 호텔/숙소 3개 추천:
  - 호텔 이름과 위치
  - 1박 평균 가격
  - 별점 (rating)
  - 추천 이유
  - 사용자 리뷰 2-3개
  - 예약 사이트 정보
  - 특징/편의시설 목록
- "Gemini AI 추천" 표시
- 실제 데이터 (Mock이 아님)

---

### 5단계: 예산 알림 테스트 ✅
**목표**: 60% 경고 단계 알림 확인

1. "숙소" 카테고리에 추가 지출 입력:
   - 금액: 200,000원
   - 설명: "추가 숙소 예약"
   - 날짜: 2026-03-03
2. "추가" 클릭

**예상 결과**:
- 숙소 총 사용: 450,000원 (750,000원 예산 대비 75%)
- 상단에 예산 알림 배너 표시:
  - 레벨: "danger" (빨간색) 또는 "warning" (노란색)
  - 메시지: "⚠️ 숙소 예산의 75%를 사용했습니다. 남은 예산: 150,000원"
- 숙소 카테고리 프로그레스 바 빨간색/노란색으로 변경

---

### 6단계: 예산 초과 테스트 ✅
**목표**: 100% 초과 알림 확인

1. "숙소" 카테고리에 대량 지출 입력:
   - 금액: 400,000원
   - 설명: "고급 호텔 추가 예약"
   - 날짜: 2026-03-04
2. "추가" 클릭

**예상 결과**:
- 숙소 총 사용: 850,000원 (600,000원 예산 대비 142%)
- 예산 초과 알림:
  - "⛔ 숙소 예산을 250,000원 초과했습니다! (142% 사용)"
  - 빨간색 배경
- 프로그레스 바 100% 넘어서 표시 (빨간색)

---

### 7단계: 트랜잭션 삭제 ✅
**목표**: 잘못 입력한 지출 삭제하기

1. 트랜잭션 목록에서 "고급 호텔 추가 예약" 찾기
2. 우측 "🗑️ 삭제" 버튼 클릭
3. 확인 창에서 "삭제" 클릭

**예상 결과**:
- 해당 트랜잭션 목록에서 제거됨
- 숙소 사용 금액: 450,000원으로 복구
- 알림 레벨 "danger"로 복구 (초과 알림 사라짐)
- 프로그레스 바 75%로 업데이트

---

### 8단계: 실시간 동기화 테스트 (선택) ✅
**목표**: Socket.io 실시간 업데이트 확인

**준비**:
1. 같은 프로젝트를 두 개의 브라우저 탭에서 열기
2. 탭 A와 탭 B 나란히 배치

**테스트**:
1. 탭 A에서 새 트랜잭션 추가
2. 탭 B를 관찰

**예상 결과**:
- 탭 B에서 자동으로 새 트랜잭션 표시 (새로고침 없이)
- 예산 사용률 실시간 업데이트
- 알림 배너 실시간 업데이트

---

### 9단계: 다른 카테고리 AI 추천 ✅
**목표**: 식비, 활동, 교통 추천 받기

1. "식비" 카테고리 클릭
   - 예상: 실제 레스토랑/맛집 3개
   - 대표 메뉴, 가격, 영업시간, 리뷰

2. "활동" 카테고리 클릭
   - 예상: 실제 관광지/체험 3개
   - 입장료, 소요 시간, 예약 방법, 팁

3. "교통" 카테고리 클릭
   - 예상: 실제 교통수단 3가지
   - 항공, 렌터카, 대중교통 패스 등
   - 가격, 예약 방법, 이용 후기

**예상 결과**:
- 각 카테고리마다 실제 데이터 기반 추천
- Gemini AI 아이콘 표시
- 24시간 캐싱 (같은 카테고리 재클릭 시 즉시 표시)

---

### 10단계: 환율 조회 (선택) ✅
**목표**: 외화 지출 환산

**개발자 도구 콘솔에서 테스트**:
```javascript
// 환율 조회
fetch('/api/exchange-rate/USD/KRW')
  .then(r => r.json())
  .then(console.log);

// 예상 결과: { rate: 1441.96, from: 'USD', to: 'KRW', cached: true/false }
```

**또는 직접 URL**:
- http://localhost:3000/api/exchange-rate/USD/KRW
- http://localhost:3000/api/exchange-rate/JPY/KRW
- http://localhost:3000/api/exchange-rate/EUR/KRW

---

## ✅ 체크리스트

모든 테스트를 완료했다면 아래 항목을 확인하세요:

- [ ] 프로젝트 생성 성공
- [ ] 예산 카테고리 자동 배분
- [ ] 트랜잭션 추가 성공
- [ ] 예산 사용률 정확히 계산
- [ ] AI 추천 (숙소) 실제 데이터 표시
- [ ] AI 추천 (식비) 실제 데이터 표시
- [ ] AI 추천 (활동) 실제 데이터 표시
- [ ] 60% 경고 알림 표시
- [ ] 80% 위험 알림 표시
- [ ] 100% 초과 알림 표시
- [ ] 트랜잭션 삭제 성공
- [ ] 삭제 후 예산 복구
- [ ] 실시간 동기화 (Socket.io)
- [ ] 환율 조회 성공

---

## 🐛 문제 발생 시

### 서버 오류
```bash
# 서버 재시작
./start.sh
```

### 브라우저 콘솔 오류
1. F12로 개발자 도구 열기
2. Console 탭에서 오류 메시지 확인
3. Network 탭에서 실패한 API 요청 확인

### 데이터베이스 초기화
```bash
# 프로젝트 데이터 삭제
rm backend/data/projects.db
rm backend/data/destinations.db

# 서버 재시작
./start.sh
```

---

## 📊 성공 기준

**모든 주요 기능이 정상 작동해야 합니다**:
1. ✅ 프로젝트 CRUD
2. ✅ 예산 카테고리 관리
3. ✅ 트랜잭션 추가/삭제
4. ✅ AI 추천 (실제 데이터)
5. ✅ 예산 알림 (60%, 80%, 100%)
6. ✅ 실시간 동기화
7. ✅ 환율 조회

**성능 기준**:
- AI 추천 로딩: 3초 이내
- 트랜잭션 추가: 즉시 반영
- 실시간 동기화: 1초 이내

---

## 🎉 테스트 완료!

모든 테스트가 통과했다면 TravelPMS v2의 예산 관리 시스템이 정상 작동합니다!

문제가 있다면:
1. 서버 로그 확인: `tail -f /tmp/travelpms.log`
2. 브라우저 콘솔 확인
3. 네트워크 탭에서 API 응답 확인
